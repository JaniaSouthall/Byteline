<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header>
        <nav>
          <a href="index.html">Home</a>
          <a href="about.html">About</a>
          <a href="cart.html">Cart</a>
        </nav>
      </header>
    <main>
      <section class="cart-container">
        <div class="cart-header">
          Your Cart
        </div>
        <section class="cart-section">
          <div class="cart-box" id="cart-items">
            <!-- Cart items will be dynamically inserted here -->
          </div>
          <a href="checkout.html">
            <button>Checkout</button>
          </a>
        </section>
      </section>
    </main>

    <div class="footer">
      &copy; 2025 ByteLine Project â€“ Built by HU Students ðŸ’»
    </div>

    <script>
      function loadCart() {
          const email = 'user@example.com'; // Replace with the logged-in user's email
  
          fetch(`http://localhost:5004/api/cart/${email}`)
              .then(response => response.json())
              .then(cart => {
                  const cartItemsContainer = document.getElementById('cart-items');
  
                  if (cart.length === 0) {
                      cartItemsContainer.innerHTML = '<p>Your cart is empty.</p>';
                      return;
                  }
  
                  cart.forEach(item => {
                      const cartItem = document.createElement('section');
                      cartItem.className = 'cart-item';
                      cartItem.innerHTML = `
                          <div class="cart-image">
                              <img src="${item.image}" alt="${item.name}" style="max-width: 100px; height: auto;">
                          </div>
                          <div class="cart-name">
                              ${item.name}
                          </div>
                          <div class="cart-price">
                              $${parseFloat(item.price).toFixed(2)}
                          </div>
                          <div class="cart-remove">
                              <button onclick="removeFromCart('${item.serial}')">Remove</button>
                          </div>
                      `;
                      cartItemsContainer.appendChild(cartItem);
                  });
              })
              .catch(err => {
                  console.error('Failed to load cart:', err);
              });
      }
  
      function removeFromCart(serial) {
          const email = 'jania.southall@my.hamptonu.edu'; // Replace with the logged-in user's email
  
          fetch('http://localhost:5004/api/cart/remove', {
              method: 'DELETE',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify({ email, serial: serial })
          })
          .then(response => response.json())
          .then(data => {
              alert(data.message);
              loadCart(); // Reload the cart
          })
          .catch(err => {
              console.error('Failed to remove item from cart:', err);
          });
      }
  
      loadCart();
  </script>

</body>
</html>