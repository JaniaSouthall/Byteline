<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header>
        <nav>
            <a href="index.html">Home</a>
            <a href="about.html">About</a>
            <a href="cart.html">Cart</a>
        </nav>
    </header>
    <main>
        <section class="search-section">
            <div class="search-header">
                Search all of our products here!
            </div>
            <div class="search-bar">
                <input id="search-input" type="text" placeholder="Search.." style="width:95%;">
                <button id="search-button">Search</button>
            </div>
        </section>
        <section id="product-container" class="product-grid"></section>
    </main>
    <div class="footer">
        &copy; 2025 ByteLine Project â€“ Built by HU Students ðŸ’»
    </div>

    <script>
        async function searchProducts() {
            const query = document.getElementById('search-input').value;
            if (!query) return; // Do nothing if the search box is empty

            try {
                const response = await fetch(`http://localhost:5004/api/search?query=${encodeURIComponent(query)}`);
                const products = await response.json();

                const container = document.getElementById('product-container');
                container.innerHTML = ''; // Clear previous results

                if (products.length === 0) {
                    container.innerHTML = '<p>No products found.</p>';
                    return;
                }

                products.forEach(product => {
                    const card = document.createElement('div');
                    card.className = 'product-card';
                    card.innerHTML = `
                        <img src="${product.image}" alt="${product.name}">
                        <h2>${product.name}</h2>
                        <p>$${parseFloat(product.price).toFixed(2)}</p>
                        <p>Category: ${product.category}</p>
                        <button onclick="viewProduct('${product.name}', '${product.image}', '${product.price}', '${product.brand}', '${product.description}', '${product.stock}', '${product.serial}')">View Product</button>
                    `;
                    container.appendChild(card);
                });
            } catch (err) {
                console.error('Failed to fetch products:', err);
            }
        }

        function viewProduct(name, image, price, brand, description, stock, serial) {
            const params = new URLSearchParams({
                name,
                image,
                price,
                brand,
                description,
                stock,
                serial
            });
            window.location.href = `productview.html?${params.toString()}`;
        }

        document.getElementById('search-button').addEventListener('click', searchProducts);
    </script>

</body>
</html>